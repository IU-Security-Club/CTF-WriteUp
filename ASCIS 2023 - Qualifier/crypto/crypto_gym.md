# ASCIS 2023 - CRYPTO_GYM
### Context
We have 2 files which are **pushup.sage** and **output.txt**:<br>
*pushup.sage*
```py
from Crypto.Util.number import *

flag = b"ASCIS{W3llDone_hitting_the_crypto_gym}"
p = random_prime(2^64,False,2^63)
k = 100
N = p^k
R.<x> = PolynomialRing(Zmod(N), implementation="NTL")

pol = R([getrandbits(303) for _ in range(8)])
rem = pol(bytes_to_long(flag))
pol2 = pol - rem

print(p)
print(pol2)
```
*output.txt*
```
p = 11297687362481059303
pol2 = 13610397498137460052595710607775600966440673986561720083617038392214152560062011019976773770*x^7 + 3566392303389726626006032793588065859583087165101596345460586029577767956788324980852746288*x^6 + 7227318468293576946551014881082996672111192766111924180025635102400282562890972644421351500*x^5 + 7771302680925353252595662292109560220768956546753457049454904993425020919927767061221486221*x^4 + 139083310005991713122570444648981888435044361344964087355309478527640012858625517580301911*x^3 + 10431965883129539716182417642690446218733007501683833779007525409139657460951379770712373102*x^2 + 2655891997688433325155635727515206873804011670907688662530856511275429726187800190339210214*x + 1990468213382663050992514193186549986027466683418508635770777413817551279002416425502329820086861584095472837291418005624773513401408758670436382582234048163799788806226626593153501000046514398963951902046012093096889627829382025385675885186988109953010009115770485200550815315808412991631351114821645247484757612802395935646091741255310372634948676346139337203740284867648614092382676490768142323752125479973383639263480304615000184481073131150356830470611732683436270896044490259474247417693471208508957222774925150961910011882960781392579006359531632257744162604999333815810546399453824586710812096069645634464088126006346744764154042984373078867489476719514098331516466106097935211336674536065610816999665679040973651579582751231452003697987383534147985850684095100628612367594611200815680857874889854961710361062023098850129552718682182379299432474772126322312705937896898977384049986981576727484443307309856882552658648662622011836915288387316856549038216691517631404710419267570370185868331551998817164408824273037138508139872246840469178118447891408840689533252470570577069433326089871730774552442047182123932923084697422550196675689928558048170639744494377903971022314792618672680983240190918645044793065660686668847439068894202593794701984461427031780284501758478606643641114708694491715239872860200373088774910354567584766353453900023065619777887852835339101628894266209543584386397885981697802413486043807559982651878851431362770011433278158871282099680537195876295632087913919009624832811111375020850262854356800201139600896028683597688967045073054430644328634631654532540097138840888709833107492434165723295378716876382870562787875916326125400715648718443161316211216677436938376005080710347157377831498391277043220453740841631935922506793862323094941018556991395626031998291221412221183144473483101854286315619799724635496211825342536058324502706123278966607771777568594929815999891921492775
```
### Approach
from:
```py
p = random_prime(2^64,False,2^63)
k = 100
N = p^k
```
We can see that **N** is very large, more than 6000 bits, which mean that ```Zmod(N)``` do nothing to Polynomial ```pol``` <br>
From the output.txt we can have:
```py
pol = 13610397498137460052595710607775600966440673986561720083617038392214152560062011019976773770*x^7 + 3566392303389726626006032793588065859583087165101596345460586029577767956788324980852746288*x^6 + 7227318468293576946551014881082996672111192766111924180025635102400282562890972644421351500*x^5 + 7771302680925353252595662292109560220768956546753457049454904993425020919927767061221486221*x^4 + 139083310005991713122570444648981888435044361344964087355309478527640012858625517580301911*x^3 + 10431965883129539716182417642690446218733007501683833779007525409139657460951379770712373102*x^2 + 2655891997688433325155635727515206873804011670907688662530856511275429726187800190339210214*x+r
```
I will set ```bytes_to_long(flag) = f``` for demonstration<br>
And so, I have:
```py
rem = 13610397498137460052595710607775600966440673986561720083617038392214152560062011019976773770*f^7 + 3566392303389726626006032793588065859583087165101596345460586029577767956788324980852746288*f^6 + 7227318468293576946551014881082996672111192766111924180025635102400282562890972644421351500*f^5 + 7771302680925353252595662292109560220768956546753457049454904993425020919927767061221486221*f^4 + 139083310005991713122570444648981888435044361344964087355309478527640012858625517580301911*f^3 + 10431965883129539716182417642690446218733007501683833779007525409139657460951379770712373102*f^2 + 2655891997688433325155635727515206873804011670907688662530856511275429726187800190339210214*f+r
```
We do not know f yet, but we know that rem is a *interger*, not *Polynomial*<br>
So when we take ```pol2 = pol - rem```, the **r** in ``pol`` and ``rem`` will mutually exclusive, this will result in negative:
```
pol2 = 13610397498137460052595710607775600966440673986561720083617038392214152560062011019976773770*x^7 + 3566392303389726626006032793588065859583087165101596345460586029577767956788324980852746288*x^6 + 7227318468293576946551014881082996672111192766111924180025635102400282562890972644421351500*x^5 + 7771302680925353252595662292109560220768956546753457049454904993425020919927767061221486221*x^4 + 139083310005991713122570444648981888435044361344964087355309478527640012858625517580301911*x^3 + 10431965883129539716182417642690446218733007501683833779007525409139657460951379770712373102*x^2 + 2655891997688433325155635727515206873804011670907688662530856511275429726187800190339210214*x - (13610397498137460052595710607775600966440673986561720083617038392214152560062011019976773770*f^7 + 3566392303389726626006032793588065859583087165101596345460586029577767956788324980852746288*f^6 + 7227318468293576946551014881082996672111192766111924180025635102400282562890972644421351500*f^5 + 7771302680925353252595662292109560220768956546753457049454904993425020919927767061221486221*f^4 + 139083310005991713122570444648981888435044361344964087355309478527640012858625517580301911*f^3 + 10431965883129539716182417642690446218733007501683833779007525409139657460951379770712373102*f^2 + 2655891997688433325155635727515206873804011670907688662530856511275429726187800190339210214*f)
```
But since the polynomial mod ```N```, the output will have:
```py
N - 13610397498137460052595710607775600966440673986561720083617038392214152560062011019976773770*f^7 + 3566392303389726626006032793588065859583087165101596345460586029577767956788324980852746288*f^6 + 7227318468293576946551014881082996672111192766111924180025635102400282562890972644421351500*f^5 + 7771302680925353252595662292109560220768956546753457049454904993425020919927767061221486221*f^4 + 139083310005991713122570444648981888435044361344964087355309478527640012858625517580301911*f^3 + 10431965883129539716182417642690446218733007501683833779007525409139657460951379770712373102*f^2 + 2655891997688433325155635727515206873804011670907688662530856511275429726187800190339210214*f = 1990468213382663050992514193186549986027466683418508635770777413817551279002416425502329820086861584095472837291418005624773513401408758670436382582234048163799788806226626593153501000046514398963951902046012093096889627829382025385675885186988109953010009115770485200550815315808412991631351114821645247484757612802395935646091741255310372634948676346139337203740284867648614092382676490768142323752125479973383639263480304615000184481073131150356830470611732683436270896044490259474247417693471208508957222774925150961910011882960781392579006359531632257744162604999333815810546399453824586710812096069645634464088126006346744764154042984373078867489476719514098331516466106097935211336674536065610816999665679040973651579582751231452003697987383534147985850684095100628612367594611200815680857874889854961710361062023098850129552718682182379299432474772126322312705937896898977384049986981576727484443307309856882552658648662622011836915288387316856549038216691517631404710419267570370185868331551998817164408824273037138508139872246840469178118447891408840689533252470570577069433326089871730774552442047182123932923084697422550196675689928558048170639744494377903971022314792618672680983240190918645044793065660686668847439068894202593794701984461427031780284501758478606643641114708694491715239872860200373088774910354567584766353453900023065619777887852835339101628894266209543584386397885981697802413486043807559982651878851431362770011433278158871282099680537195876295632087913919009624832811111375020850262854356800201139600896028683597688967045073054430644328634631654532540097138840888709833107492434165723295378716876382870562787875916326125400715648718443161316211216677436938376005080710347157377831498391277043220453740841631935922506793862323094941018556991395626031998291221412221183144473483101854286315619799724635496211825342536058324502706123278966607771777568594929815999891921492775
```
After take ```N``` minus the big number, we have:
```py
13610397498137460052595710607775600966440673986561720083617038392214152560062011019976773770*f^7 + 3566392303389726626006032793588065859583087165101596345460586029577767956788324980852746288*f^6 + 7227318468293576946551014881082996672111192766111924180025635102400282562890972644421351500*f^5 + 7771302680925353252595662292109560220768956546753457049454904993425020919927767061221486221*f^4 + 139083310005991713122570444648981888435044361344964087355309478527640012858625517580301911*f^3 + 10431965883129539716182417642690446218733007501683833779007525409139657460951379770712373102*f^2 + 2655891997688433325155635727515206873804011670907688662530856511275429726187800190339210214*f = 37461846221206989060105205682855295492043168382257649019927793320589820993408167410042054674664607928625417133935717456020681217811520137314323053261556842335605253876136172814066771289184754310101603506122935725503057809006330594996194361690365615165930585893134753068257303441703512240832959202094605720216163969915306569867173070678958669306632864083880515184475641489022976170587364186569547461251208417097315344117090129322231668014512075516211084510670781348951110696510964843585095536080211350301996020248471446197349556861328639370699156175056152338374849988523234302548736691549819988681381624521007955562483602487049182918506946355229745379201776803973022375027788658405522530723325712482033716162275838323148310839226
```
From this, we easily get the root of the polymonial and so the flag:
```py
f =  13610397498137460052595710607775600966440673986561720083617038392214152560062011019976773770*x^7 + 3566392303389726626006032793588065859583087165101596345460586029577767956788324980852746288*x^6 + 7227318468293576946551014881082996672111192766111924180025635102400282562890972644421351500*x^5 + 7771302680925353252595662292109560220768956546753457049454904993425020919927767061221486221*x^4 + 139083310005991713122570444648981888435044361344964087355309478527640012858625517580301911*x^3 + 10431965883129539716182417642690446218733007501683833779007525409139657460951379770712373102*x^2 + 2655891997688433325155635727515206873804011670907688662530856511275429726187800190339210214*x - 37461846221206989060105205682855295492043168382257649019927793320589820993408167410042054674664607928625417133935717456020681217811520137314323053261556842335605253876136172814066771289184754310101603506122935725503057809006330594996194361690365615165930585893134753068257303441703512240832959202094605720216163969915306569867173070678958669306632864083880515184475641489022976170587364186569547461251208417097315344117090129322231668014512075516211084510670781348951110696510964843585095536080211350301996020248471446197349556861328639370699156175056152338374849988523234302548736691549819988681381624521007955562483602487049182918506946355229745379201776803973022375027788658405522530723325712482033716162275838323148310839226

roots=list(f.roots())[0]
for i in roots:
	try:
		print(long_to_bytes(int(i)))
	except:
		continue
```
```
b'ASCIS{W3llDone_hitting_the_crypto_gym}'
```